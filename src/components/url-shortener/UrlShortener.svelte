// Original code from commit f46d293c8c240b4629e5540663fce763138a16af goes here...